import{d as g,r as y,c as u,e as t,w as c,O as k,a as r,b as m,aH as S,G as B,B as C,aI as I,a4 as N,F,y as T,aJ as U,m as V,k as j,aa as A,ab as D,v as O,aq as q,_ as G}from"./index-CCtaBiha.js";/* empty css                        *//* empty css                    *//* empty css               *//* empty css                  *//* empty css                    */import{r as H,u as J}from"./xlsx-BVI6F0ko.js";const b=n=>(A("data-v-a5da11cc"),n=n(),D(),n),L={class:"excel-import-container"},M={class:"upload-area"},P=b(()=>m("div",{class:"el-upload__text"},[j(" 将文件拖到此处，或"),m("em",null,"点击上传")],-1)),R=b(()=>m("div",{class:"el-upload__tip"}," 只能上传 .xlsx 或 .xls 格式文件 ",-1)),z={key:0,class:"data-display"},K={key:1,class:"empty-placeholder"},Q=g({__name:"ExcelUpload",setup(n){const h=y([]),x=y([]),v=async d=>{try{const e=await E(d.raw);e&&e.length>0&&(e.length>0&&(x.value=Object.keys(e[0]).map(a=>({prop:a,label:a}))),h.value=e)}catch(e){console.error("导入Excel失败:",e),V.error("导入Excel失败，请检查文件格式")}},E=d=>new Promise((e,a)=>{const o=new FileReader;o.onload=s=>{var p;try{const l=(p=s.target)==null?void 0:p.result,_=H(l,{type:"array"}),i=_.SheetNames[0],f=_.Sheets[i],w=J.sheet_to_json(f);e(w)}catch(l){a(l)}},o.onerror=s=>a(s),o.readAsArrayBuffer(d)});return(d,e)=>{const a=B,o=S,s=q,p=N,l=U,_=k;return r(),u("div",L,[t(_,{class:"import-card"},{default:c(()=>[m("div",M,[t(o,{class:"upload-demo",drag:"",action:"","auto-upload":!1,"show-file-list":!1,"on-change":v,accept:".xlsx, .xls"},{tip:c(()=>[R]),default:c(()=>[t(a,{class:"el-icon--upload"},{default:c(()=>[t(C(I))]),_:1}),P]),_:1})]),h.value.length>0?(r(),u("div",z,[t(p,{data:h.value,border:"",style:{width:"100%"},height:"400"},{default:c(()=>[(r(!0),u(F,null,T(x.value,(i,f)=>(r(),O(s,{key:f,prop:i.prop,label:i.label,"min-width":"120"},null,8,["prop","label"]))),128))]),_:1},8,["data"])])):(r(),u("div",K,[t(l,{description:"暂无数据"})]))]),_:1})])}}}),te=G(Q,[["__scopeId","data-v-a5da11cc"]]);export{te as default};
